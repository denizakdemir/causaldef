% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/deficiency.R
\name{estimate_deficiency}
\alias{estimate_deficiency}
\title{Estimate a Deficiency Proxy (PS-TV)}
\usage{
estimate_deficiency(
  spec,
  methods = c("iptw", "aipw"),
  treatment_value = NULL,
  n_boot = 200,
  ci_level = 0.95,
  verbose = TRUE,
  parallel = FALSE
)
}
\arguments{
\item{spec}{A causal_spec object}

\item{methods}{Character vector: adjustment methods to compare
\itemize{
\item "unadjusted": No adjustment (baseline)
\item "iptw": Inverse probability weighting
\item "aipw": Augmented IPW (doubly robust)
\item "tmle": Targeted maximum likelihood estimation (requires tmle package)
\item "matching": Propensity score matching (requires MatchIt package)
\item "grf": Generalized random forests (requires grf package)
\item "cox_iptw": Cox model with IPTW (survival outcomes, requires survival)
}}

\item{treatment_value}{Numeric: intervention value for do(A=a)}

\item{n_boot}{Integer: bootstrap replicates for CI (0 = none)}

\item{ci_level}{Numeric: confidence level (default 0.95)}

\item{verbose}{Logical: show progress}

\item{parallel}{Logical: use parallel processing for bootstrap (requires future.apply)}
}
\value{
Object of class "deficiency" containing:
\itemize{
\item estimates: Named vector of deficiency proxy estimates per method
\item se: Standard errors (if n_boot > 0)
\item ci: Confidence intervals
\item method: Methods used
\item kernel: Fitted kernels for each method
\item metric: Identifier for the proxy metric used
}
}
\description{
Computes a \emph{computable proxy} for the (population) Le Cam deficiency between
observational and interventional regimes under various adjustment strategies.
}
\details{
The (population) Le Cam deficiency is defined as:
\deqn{\delta(\mathcal{E}_{obs}, \mathcal{E}_{do}) =
      \inf_K \sup_\theta ||KP^{obs}_\theta - P^{do}_\theta||_{TV}}

This quantity is not directly estimable nonparametrically from finite samples
without additional structure. The current implementation returns a proxy based on
the total variation distance between \emph{propensity-score distributions} under:
\enumerate{
\item the method-induced reweighting (pseudo-population), and
\item the unweighted target population.
}
This PS-TV proxy is an overlap/balance diagnostic: values near 0 indicate near-perfect
balance under the estimated propensity model, while large values flag positivity/overlap issues.

Importantly, this is a \emph{proxy} and should not be interpreted as the exact Le Cam deficiency
unless supplemented by a result linking the proxy to the specific decision class of interest.
}
\examples{
# Create sample data
n <- 200
W <- rnorm(n)
A <- rbinom(n, 1, plogis(0.5 * W))
Y <- 1 + 2 * A + W + rnorm(n)
df <- data.frame(W = W, A = A, Y = Y)

spec <- causal_spec(df, "A", "Y", "W")
results <- estimate_deficiency(spec, methods = c("unadjusted", "iptw"), n_boot = 50)
print(results)

}
\seealso{
\code{\link[=causal_spec]{causal_spec()}}, \code{\link[=nc_diagnostic]{nc_diagnostic()}}, \code{\link[=policy_regret_bound]{policy_regret_bound()}}
}
